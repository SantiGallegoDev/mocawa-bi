<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mocawa Cafe - BI Dashboard</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>☕</text></svg>">
    <link rel="stylesheet" href="assets/style.css">
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <h1>☕ Mocawa Cafe - Dashboard BI</h1>
        <p class="subtitle" id="dateRange">Cargando datos...</p>
        <a href="analysis.html" style="display:inline-block;margin-top:8px;background:#ff5023;color:#fff;padding:6px 18px;border-radius:6px;text-decoration:none;font-size:0.85rem;font-weight:600;">Ver Analisis Estrategico &rarr;</a>
    </header>

    <!-- KPI Cards -->
    <section class="kpi-grid" id="kpiGrid">
        <div class="kpi-card" id="kpi-revenue"><span class="kpi-label">Ingresos Totales</span><span class="kpi-value">—</span></div>
        <div class="kpi-card" id="kpi-sales"><span class="kpi-label">Total Ventas</span><span class="kpi-value">—</span></div>
        <div class="kpi-card" id="kpi-ticket"><span class="kpi-label">Ticket Promedio</span><span class="kpi-value">—</span></div>
        <div class="kpi-card" id="kpi-items"><span class="kpi-label">Items Vendidos</span><span class="kpi-value">—</span></div>
        <div class="kpi-card" id="kpi-margin"><span class="kpi-label">Margen Bruto</span><span class="kpi-value">—</span></div>
        <div class="kpi-card" id="kpi-profit"><span class="kpi-label">Ganancia Bruta</span><span class="kpi-value">—</span></div>
        <div class="kpi-card" id="kpi-daily-rev"><span class="kpi-label">Ingreso Diario Prom.</span><span class="kpi-value">—</span></div>
        <div class="kpi-card" id="kpi-daily-sales"><span class="kpi-label">Ventas/Dia Prom.</span><span class="kpi-value">—</span></div>
        <div class="kpi-card" id="kpi-items-ticket"><span class="kpi-label">Items/Ticket</span><span class="kpi-value">—</span></div>
        <div class="kpi-card" id="kpi-peak"><span class="kpi-label">Hora Pico</span><span class="kpi-value">—</span></div>
        <div class="kpi-card" id="kpi-canceled"><span class="kpi-label">Ventas Canceladas</span><span class="kpi-value">—</span><span class="kpi-delta"></span></div>
        <div class="kpi-card" id="kpi-duration"><span class="kpi-label">Duracion Prom.</span><span class="kpi-value">—</span></div>
    </section>

    <hr class="divider">

    <!-- Tab Bar -->
    <nav class="tab-bar">
        <button class="tab-btn active" data-tab="overview">Resumen General</button>
        <button class="tab-btn" data-tab="products">Productos</button>
        <button class="tab-btn" data-tab="payments">Pagos</button>
        <button class="tab-btn" data-tab="staff">Staff</button>
        <button class="tab-btn" data-tab="time">Horarios</button>
        <button class="tab-btn" data-tab="profit">Rentabilidad</button>
        <button class="tab-btn" data-tab="detail">Detalle</button>
    </nav>

    <!-- Tab: Resumen General -->
    <section class="tab-content active" id="tab-overview">
        <h2>Ingresos en el Tiempo</h2>
        <div class="radio-group" id="granularity">
            <label><input type="radio" name="gran" value="daily"> Diario</label>
            <label><input type="radio" name="gran" value="weekly"> Semanal</label>
            <label><input type="radio" name="gran" value="monthly" checked> Mensual</label>
        </div>
        <div class="chart" id="chart-revenue"></div>
        <hr class="divider">
        <div class="row-2">
            <div>
                <h2>Comparacion Anual</h2>
                <div class="chart" id="chart-yoy"></div>
            </div>
            <div>
                <h2>Tipo de Venta en el Tiempo</h2>
                <div class="chart" id="chart-type-trend"></div>
            </div>
        </div>
        <hr class="divider">
        <div class="row-2">
            <div>
                <h2>Ingresos por Dia de Semana</h2>
                <div class="chart" id="chart-dow"></div>
            </div>
            <div>
                <h2>Distribucion por Tipo de Venta</h2>
                <div class="chart" id="chart-type-dist"></div>
            </div>
        </div>
        <hr class="divider">
        <div class="row-2">
            <div>
                <h2>Ingresos Acumulados</h2>
                <div class="chart" id="chart-cumulative"></div>
            </div>
            <div>
                <h2>Crecimiento Mensual %</h2>
                <div class="chart" id="chart-growth"></div>
            </div>
        </div>
        <hr class="divider">
        <h2>Distribucion de Ticket</h2>
        <div class="row-2">
            <div>
                <div class="chart" id="chart-histogram"></div>
            </div>
            <div>
                <div class="chart" id="chart-boxplot"></div>
            </div>
        </div>
    </section>

    <!-- Tab: Productos -->
    <section class="tab-content" id="tab-products">
        <h2>Analisis de Productos</h2>
        <div class="row-2">
            <div>
                <h3>Top 20 por Ingresos</h3>
                <div class="chart" id="chart-top-rev"></div>
            </div>
            <div>
                <h3>Top 20 por Cantidad</h3>
                <div class="chart" id="chart-top-qty"></div>
            </div>
        </div>
        <hr class="divider">
        <div class="row-2">
            <div>
                <h2>Ventas por Categoria</h2>
                <div class="chart" id="chart-cat-pie"></div>
            </div>
            <div>
                <h2>Tendencia por Categoria</h2>
                <div class="chart" id="chart-cat-trend"></div>
            </div>
        </div>
        <hr class="divider">
        <h2>Treemap de Productos</h2>
        <div class="chart" id="chart-treemap"></div>
        <hr class="divider">
        <h2>Tabla Completa de Productos</h2>
        <div class="table-container" id="product-table"></div>
    </section>

    <!-- Tab: Pagos -->
    <section class="tab-content" id="tab-payments">
        <h2>Analisis de Metodos de Pago</h2>
        <div class="row-2">
            <div>
                <h3>Distribucion por Metodo</h3>
                <div class="chart" id="chart-pay-dist"></div>
            </div>
            <div>
                <h3>Conteo de Transacciones por Metodo</h3>
                <div class="chart" id="chart-pay-count"></div>
            </div>
        </div>
        <hr class="divider">
        <h2>Tendencia de Metodos de Pago</h2>
        <div class="chart" id="chart-pay-trend"></div>
        <hr class="divider">
        <h2>Participacion % de Metodos en el Tiempo</h2>
        <div class="chart" id="chart-pay-share"></div>
        <hr class="divider">
        <h2>Monto Promedio por Metodo</h2>
        <div class="chart" id="chart-pay-avg"></div>
    </section>

    <!-- Tab: Staff -->
    <section class="tab-content" id="tab-staff">
        <h2>Rendimiento por Mesero/a</h2>
        <div class="row-2">
            <div>
                <h3>Ingresos por Mesero/a</h3>
                <div class="chart" id="chart-waiter-rev"></div>
            </div>
            <div>
                <h3>Ticket Promedio por Mesero/a</h3>
                <div class="chart" id="chart-waiter-ticket"></div>
            </div>
        </div>
        <hr class="divider">
        <h2>Tabla de Rendimiento</h2>
        <div class="table-container" id="waiter-table"></div>
        <hr class="divider">
        <h2>Actividad de Staff en el Tiempo</h2>
        <div class="chart" id="chart-waiter-time"></div>
        <hr class="divider">
        <h2>Rendimiento Mensual por Mesero/a</h2>
        <div style="display:flex;align-items:center;gap:12px;margin-bottom:12px;flex-wrap:wrap;">
            <label for="month-select" style="color:#a0a0b0;font-size:0.9rem;">Mes:</label>
            <select id="month-select" style="background:#1a1a2e;color:#fafafa;border:1px solid #2a2a3e;border-radius:6px;padding:6px 12px;font-size:0.9rem;"></select>
        </div>
        <div class="row-2">
            <div>
                <h3>Ventas e Ingresos por Mesero</h3>
                <div class="chart" id="chart-waiter-monthly-rev"></div>
            </div>
            <div>
                <h3>Duracion Promedio por Pedido (min)</h3>
                <div class="chart" id="chart-waiter-monthly-dur"></div>
            </div>
        </div>
        <div class="table-container" id="waiter-monthly-table"></div>
    </section>

    <!-- Tab: Horarios -->
    <section class="tab-content" id="tab-time">
        <h2>Patrones de Horario</h2>
        <h3>Mapa de Calor: Ingresos por Dia y Hora</h3>
        <div class="chart" id="chart-heatmap-rev"></div>
        <hr class="divider">
        <div class="row-2">
            <div>
                <h3>Ingresos por Hora del Dia</h3>
                <div class="chart" id="chart-hourly"></div>
            </div>
            <div>
                <h3>Ventas por Dia de Semana</h3>
                <div class="chart" id="chart-dow2"></div>
            </div>
        </div>
        <hr class="divider">
        <h3>Mapa de Calor: Cantidad de Ventas por Dia y Hora</h3>
        <div class="chart" id="chart-heatmap-sales"></div>
    </section>

    <!-- Tab: Rentabilidad -->
    <section class="tab-content" id="tab-profit">
        <h2>Analisis de Rentabilidad</h2>
        <div class="row-2">
            <div>
                <h3>Margen Bruto % por Categoria</h3>
                <div class="chart" id="chart-cat-margin"></div>
            </div>
            <div>
                <h3>Ganancia Bruta por Categoria ($)</h3>
                <div class="chart" id="chart-cat-profit"></div>
            </div>
        </div>
        <hr class="divider">
        <h2>Margen Bruto % en el Tiempo</h2>
        <div class="chart" id="chart-margin-time"></div>
        <hr class="divider">
        <div class="row-2">
            <div>
                <h3>Top 15 Mas Rentables ($)</h3>
                <div class="table-container" id="top-margin-table"></div>
            </div>
            <div>
                <h3>Top 15 Menor Margen %</h3>
                <div class="table-container" id="bot-margin-table"></div>
            </div>
        </div>
        <hr class="divider">
        <h2>Productos: Ingresos vs Margen % (tamano = cantidad)</h2>
        <div class="chart" id="chart-scatter"></div>
    </section>

    <!-- Tab: Detalle -->
    <section class="tab-content" id="tab-detail">
        <h2>Datos Detallados</h2>
        <div class="row-3" id="detail-summary"></div>
        <hr class="divider">
        <div id="detail-expenses"></div>
        <h2>Ultimas 100 Ventas</h2>
        <div class="table-container" id="recent-sales-table"></div>
    </section>

    <!-- Footer -->
    <footer class="footer" id="footer">
        Mocawa Cafe BI Dashboard | Datos de FUDO POS
    </footer>

    <script src="assets/dashboard.js"></script>
</body>
</html>
